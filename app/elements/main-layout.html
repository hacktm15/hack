<!--
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->

<link rel="import" href="../bower_components/iron-icons/iron-icons.html">
<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/paper-drawer-panel/paper-drawer-panel.html">
<link rel="import" href="../bower_components/paper-header-panel/paper-header-panel.html">
<link rel="import" href="../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../bower_components/paper-item/paper-item.html">
<link rel="import" href="../bower_components/paper-menu/paper-menu.html">
<link rel="import" href="../bower_components/paper-toolbar/paper-toolbar.html">
<link rel="import" href="../bower_components/iron-ajax/iron-ajax.html">
<link rel="import" href="../bower_components/paper-input/paper-input.html">
<link rel="import" href="../bower_components/paper-button/paper-button.html">
<link rel="import" href="../bower_components/paper-material/paper-material.html">

<!--

Left Nav + List + Detail

 -->
<dom-module id="main-layout">

    <link rel="import" type="css" href="main-layout.css">

    <template>
        <!--

        Ajax request

        -->
        <iron-ajax
                id="ajax"
                url="http://cors.io/?u=http://festivalgather.azurewebsites.net/api/gather"
                handle-as="json"
                on-response="hresponse"
                debounce-duration="300">
        </iron-ajax>


        <paper-drawer-panel id="navDrawerPanel" responsive-width="1280px">
            <div drawer> 
              <paper-input label="minPrice">
                <div prefix>€</div>
                <paper-icon-button suffix icon="clear"></paper-icon-button>
              </paper-input>
            
              <paper-input label="maxPrice">
                <div prefix>€</div>
                <paper-icon-button suffix icon="clear"></paper-icon-button>
              </paper-input>
            
              <paper-button raised class="fancy">Search</paper-button>
            </div>
            <div class="nav" drawer>
                <!-- Nav Content -->
            </div>

            <paper-drawer-panel id="mainDrawerPanel" class="main-drawer-panel" main responsive-width="600px"
                                drawer-width="[[_computeListWidth(_isMobile)]]" drawer-toggle-attribute="list-toggle"
                                narrow="{{_isMobile}}">

                <paper-header-panel class="list-panel" drawer>

                    <!-- List Toolbar -->
                    <paper-toolbar>
                        <paper-icon-button icon="search" paper-drawer-toggle></paper-icon-button>
                    </paper-toolbar>

                    <!-- List -->
                    <paper-menu class="list" on-iron-activate="_listTap">

                        <template is="dom-repeat" items="{{festivals}}">
                            <paper-item on-tap="festivalSelected">
                                <paper-item-body two-line class="layout center">
                                    <img class="list-img" src="{{item.ImagePath}}">
                                    <div secondary class="legend horizontal layout center">
                                        <h3>{{item.Name}}</h3>
                                    </div>
                                    <div  class="list-img"></div>
                                </paper-item-body>
                            </paper-item>
                        </template>
                    </paper-menu>

                </paper-header-panel>

                <paper-header-panel class="content-panel" main>
                   <paper-material id ="details" class="content-card" elevation="4">
                    <div id"container-details">
                       <h1 id="title">Scottish Artists 1750-1900: From Caledonia to the Continent</h1>
                        <h3 id="detail-location">The Queen's Gallery, Palace of Holyroodhouse, Canongate, The Royal Mile, Edinburgh,  </h3>
                        <div id="date-details">
                          <h3 id="start-date">2015-11-08 09:30:00 </h3>
                          <h3 id="end-date"> 2015-11-08 15:30:00</h3>
                        </div>
                       <p id="description-details">This is the first ever exhibition devoted to Scottish 
                       art in the Royal Collection and brings together paintings, drawings and miniatures collected by 
                       monarchs from George III to Queen Victoria.\n\nIt includes the work of painters who were born in Scotland 
                       and travelled abroad, such as Allan Ramsay and Sir David Wilkie, and of those whose inspiration remained 
                       firmly rooted in their native land, such as Alexander Nasmyth and James Giles.<br> <br> In particular, the exhibition
                       highlights the importance and influence of artists whose work was shaped by the ideas of the Scottish Enlightenment.</p>
                         <div id="price-details">
                           <h1 id="price">9.0€</h1>
                            <paper-button id="get-tickets" raised class="fancy">Get tickets</paper-button>
                         </div>
                     </div>
                    </paper-material>
      
                      <paper-material class="content-card" elevation="4">
                        <paper-item class="room-booking">
                          <div >
                            <div id="room-price">9.0€</div>
                            <div id="beds-available">Beds: 2</div>
                            <div id="availability">Availability</div>
                            <paper-button id="book-now" raised class="fancy">Book now</paper-button>
                          </div>
                        </paper-item>
                     
                        <paper-item class="room-booking">test1</paper-item>
                       
                        <paper-item class="room-booking">test1</paper-item>
                      
                        <paper-item class="room-booking">test1</paper-item>
                        
                    </paper-material>
                    
                    <!-- Main Toolbar -->
                    <paper-toolbar>
                        <paper-icon-button icon="arrow-back" list-toggle></paper-icon-button>
                    </paper-toolbar>

                    <!-- Main Content -->
                    <div class="content">
                    </div>

                </paper-header-panel>

            </paper-drawer-panel>

        </paper-drawer-panel>

    </template>

    <script>

        Polymer({

            is: 'main-layout',

            _computeListWidth: function(isMobile) {
                // when in mobile screen size, make the list be 100% width to cover the whole screen
                return isMobile ? '100%' : '33%';
            },

            _listTap: function() {
                this.$.mainDrawerPanel.closeDrawer();
            },

            ready: function () {
                this.festivals = [];
                this.selectedFestival;
                this.$.ajax.generateRequest();
            },
            hresponse: function(request) {
                console.log(request.detail.response);
                this.festivals = request.detail.response;
            },
            festivalSelected: function(e) {
                console.log(e.model.item);
                this.selectedFestival = e.model.item;
            }
        });

    </script>

</dom-module>
